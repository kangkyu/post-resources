<%= render 'shared/title', title: @post.title %>

<p class="text-right">
  <% if correct_user?(@post.user) %>
    <%= link_to 'edit post', edit_post_path(@post), class: "btn btn-default" %>
  <% end %>
  <%= link_to 'back to all posts', posts_path, class: "btn btn-default" %>
</p>

<div class="row">
  <div class="col-md-1 col-sm-2 col-xs-3">

  <div class="panel panel-default text-center">
    <div class="panel-heading">
      <%= caret_up_icon(@post) %>
    </div>
    <div class="panel-body">
      <%= @post.votes.where(voted: true).count - @post.votes.where(voted: false).count %>
      <%# @post.votes.count %>
      <!-- counts -->
    </div>
    <div class="panel-footer text-center">
      <%= caret_down_icon(@post) %>
    </div>
  </div>

  </div>
  <div class="col-md-11 col-sm-10 col-xs-9">

  <div class="panel panel-default">
    <div class="panel-heading">
      <%= render @post.categories %>
      <h2><%= link_to @post.title, external_url(@post.url), target: "_blank" %></h2>
      <p>
        - added at <%= @post.created_at %> by <%= link_to @post.user.username, user_path(@post.user) %>
      </p>
    </div>
    <div class="panel-body">
      <p><%= link_to @post.url, external_url(@post.url), target: "_blank" %></p>
      <p><%= simple_format @post.description %></p>
    </div>
  </div>

  </div>
</div>

<% if user_log_in? %>
<div class="well">
  <%= form_for [@post, Comment.new] do |f| %>
    <div class="form-group">
      <%= f.text_area :body, class: "form-control" %>
    </div>
    <div class="text-right"><%= f.submit class: "btn btn-default" %></div>
  <% end %>
</div>
<% end %>

<% if @post.comments.any? %>
  <h4><%= pluralize(@post.comments.count, 'post comment') %></h4>
  <%= render @post.comments %>
<% end %>
